<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<div id="microphone-test">
    <!-- controls 显示音频 -->
    <audio ref="recordPlayer" id="audio" controls src=""></audio>
    <button onclick="startRecord()">开始录音</button>
    <button onclick="endRecord()">我说完了</button>
</div>
<script>
    let mediaDevices = null;
    function startRecord() {
        window.alert();
        navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
            mediaRecorder = new MediaRecorder(stream)
            mediaRecorder.addEventListener('dataavailable', (event) => {
                //监听录音结束后将录制的音频放入audio标签
                audio.src = URL.createObjectURL(event.data)
            })
            mediaRecorder.start() //开始录音
        }).catch((error) => {
            alert({ title: '错误', text: '开启麦克风失败！' + error })
        })
    }
    function endRecord() {
        mediaRecorder.stop() //结束录音
    }
</script>

<body>

</body>

</html>